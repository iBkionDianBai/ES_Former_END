{"ast":null,"code":"import React, { useRef, useEffect, useCallback, forwardRef, useImperativeHandle } from 'react';\nimport * as S from './style';\nimport { originalCharacter, randomColor, randomNum } from './utils';\nimport { isFunction } from 'lodash';\nimport cs from 'classnames';\nvar Captcha = forwardRef(function (_a, ref) {\n  var _b = _a.height,\n    height = _b === void 0 ? 40 : _b,\n    _c = _a.width,\n    width = _c === void 0 ? 100 : _c,\n    _d = _a.bgColor,\n    bgColor = _d === void 0 ? '#DFF0D8' : _d,\n    _e = _a.charNum,\n    charNum = _e === void 0 ? 4 : _e,\n    _f = _a.fontSize,\n    fontSize = _f === void 0 ? 25 : _f,\n    onChange = _a.onChange,\n    onClick = _a.onClick,\n    className = _a.className,\n    onRef = _a.onRef,\n    _g = _a.code,\n    code = _g === void 0 ? '' : _g;\n  var canvas = useRef(null);\n  useEffect(function () {\n    onRef && onRef(canvas);\n  }, []);\n  useImperativeHandle(ref, function () {\n    return {\n      refresh: function () {\n        canvas.current.click();\n      }\n    };\n  });\n  // 生成原始的数据\n  var generateSourceCode = useCallback(function () {\n    var array = [];\n    if (code) {\n      return code.split('');\n    }\n    for (var i = 0; i < charNum; i++) {\n      var temp = originalCharacter[randomNum(0, originalCharacter.length - 1)];\n      array.push(temp);\n    }\n    return array;\n  }, [code, charNum]);\n  var generateCaptcha = useCallback(function () {\n    var checkCode = '';\n    if (canvas.current) {\n      var ctx = canvas.current.getContext('2d');\n      if (ctx) {\n        ctx.clearRect(0, 0, width, height);\n        ctx.beginPath();\n        ctx.fillStyle = bgColor;\n        ctx.fillRect(0, 0, width, height);\n        var sourceCode = generateSourceCode();\n        for (var i = 0; i < sourceCode.length; i++) {\n          var charGap = Math.round(width / charNum);\n          var offset = Math.round(charGap / 2) - 6;\n          var code_1 = sourceCode[i];\n          checkCode += code_1;\n          ctx.save();\n          ctx.beginPath();\n          ctx.fillStyle = 'white';\n          ctx.strokeStyle = randomColor();\n          ctx.font = fontSize + \"px serif\";\n          ctx.rotate(Math.PI / 180 * randomNum(-5, 5));\n          ctx.strokeText(code_1, offset + i * charGap, height / 2 + 8);\n          ctx.beginPath();\n          ctx.moveTo(randomNum(0, width), randomNum(0, height));\n          ctx.lineTo(randomNum(0, width), randomNum(0, height));\n          ctx.stroke();\n          ctx.restore();\n        }\n        return checkCode;\n      } else {\n        return '';\n      }\n    } else {\n      return '';\n    }\n  }, [code]);\n  var handleClick = useCallback(function () {\n    if (isFunction(onChange) && !code) {\n      var captcha = generateCaptcha();\n      onChange(captcha);\n    }\n    if (isFunction(onClick)) {\n      onClick();\n    }\n  }, [onChange, code]);\n  useEffect(function () {\n    var captcha = generateCaptcha();\n    if (isFunction(onChange) && !code) {\n      onChange(captcha);\n    }\n  }, [code]);\n  return React.createElement(S.SCaptcha, {\n    className: cs('react-captcha', className),\n    onClick: handleClick,\n    height: height,\n    width: width,\n    ref: canvas\n  });\n});\nexport default Captcha;","map":{"version":3,"names":["React","useRef","useEffect","useCallback","forwardRef","useImperativeHandle","S","originalCharacter","randomColor","randomNum","isFunction","cs","Captcha","_a","ref","_b","height","_c","width","_d","bgColor","_e","charNum","_f","fontSize","onChange","onClick","className","onRef","_g","code","canvas","refresh","current","click","generateSourceCode","array","split","i","temp","length","push","generateCaptcha","checkCode","ctx","getContext","clearRect","beginPath","fillStyle","fillRect","sourceCode","charGap","Math","round","offset","code_1","save","strokeStyle","font","rotate","PI","strokeText","moveTo","lineTo","stroke","restore","handleClick","captcha","createElement","SCaptcha"],"sources":["E:/project/QinWenMingFront-end-master-II weiyuan/node_modules/react-captcha-code/build/es/captcha.js"],"sourcesContent":["import React, { useRef, useEffect, useCallback, forwardRef, useImperativeHandle } from 'react';\nimport * as S from './style';\nimport { originalCharacter, randomColor, randomNum } from './utils';\nimport { isFunction } from 'lodash';\nimport cs from 'classnames';\nvar Captcha = forwardRef(function (_a, ref) {\n    var _b = _a.height, height = _b === void 0 ? 40 : _b, _c = _a.width, width = _c === void 0 ? 100 : _c, _d = _a.bgColor, bgColor = _d === void 0 ? '#DFF0D8' : _d, _e = _a.charNum, charNum = _e === void 0 ? 4 : _e, _f = _a.fontSize, fontSize = _f === void 0 ? 25 : _f, onChange = _a.onChange, onClick = _a.onClick, className = _a.className, onRef = _a.onRef, _g = _a.code, code = _g === void 0 ? '' : _g;\n    var canvas = useRef(null);\n    useEffect(function () {\n        onRef && onRef(canvas);\n    }, []);\n    useImperativeHandle(ref, function () { return ({\n        refresh: function () {\n            canvas.current.click();\n        },\n    }); });\n    // 生成原始的数据\n    var generateSourceCode = useCallback(function () {\n        var array = [];\n        if (code) {\n            return code.split('');\n        }\n        for (var i = 0; i < charNum; i++) {\n            var temp = originalCharacter[randomNum(0, originalCharacter.length - 1)];\n            array.push(temp);\n        }\n        return array;\n    }, [code, charNum]);\n    var generateCaptcha = useCallback(function () {\n        var checkCode = '';\n        if (canvas.current) {\n            var ctx = canvas.current.getContext('2d');\n            if (ctx) {\n                ctx.clearRect(0, 0, width, height);\n                ctx.beginPath();\n                ctx.fillStyle = bgColor;\n                ctx.fillRect(0, 0, width, height);\n                var sourceCode = generateSourceCode();\n                for (var i = 0; i < sourceCode.length; i++) {\n                    var charGap = Math.round(width / charNum);\n                    var offset = Math.round(charGap / 2) - 6;\n                    var code_1 = sourceCode[i];\n                    checkCode += code_1;\n                    ctx.save();\n                    ctx.beginPath();\n                    ctx.fillStyle = 'white';\n                    ctx.strokeStyle = randomColor();\n                    ctx.font = fontSize + \"px serif\";\n                    ctx.rotate((Math.PI / 180) * randomNum(-5, 5));\n                    ctx.strokeText(code_1, offset + i * charGap, height / 2 + 8);\n                    ctx.beginPath();\n                    ctx.moveTo(randomNum(0, width), randomNum(0, height));\n                    ctx.lineTo(randomNum(0, width), randomNum(0, height));\n                    ctx.stroke();\n                    ctx.restore();\n                }\n                return checkCode;\n            }\n            else {\n                return '';\n            }\n        }\n        else {\n            return '';\n        }\n    }, [code]);\n    var handleClick = useCallback(function () {\n        if (isFunction(onChange) && !code) {\n            var captcha = generateCaptcha();\n            onChange(captcha);\n        }\n        if (isFunction(onClick)) {\n            onClick();\n        }\n    }, [onChange, code]);\n    useEffect(function () {\n        var captcha = generateCaptcha();\n        if (isFunction(onChange) && !code) {\n            onChange(captcha);\n        }\n    }, [code]);\n    return (React.createElement(S.SCaptcha, { className: cs('react-captcha', className), onClick: handleClick, height: height, width: width, ref: canvas }));\n});\nexport default Captcha;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}